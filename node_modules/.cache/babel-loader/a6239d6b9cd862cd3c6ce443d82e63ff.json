{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\oneto\\\\OneDrive\\\\Desktop\\\\blockly\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\oneto\\\\OneDrive\\\\Desktop\\\\blockly\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\Users\\\\oneto\\\\OneDrive\\\\Desktop\\\\blockly\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useRef,useState}from\"react\";import BlocklyComponent,{Block,Value,Field,Category}from\"./Blockly\";import BlocklyPython from\"blockly/python\";import{babyAiService,exportWorkspace,downloadSavedWorkspace}from\"./services/babyAiService\";import{CodeBlock,dracula}from\"react-code-blocks\";import Blockly from'blockly';import\"./blocks/customblocks\";import\"./generator/generator\";import\"./App.css\";import\"./generator/python_compressed\";//Container of result from server\nvar ConsoleComponent=function ConsoleComponent(_ref){var _ref$data=_ref.data,data=_ref$data===void 0?[]:_ref$data;var items=data.map(function(val,index){return/*#__PURE__*/React.createElement(\"div\",{className:\"itemsResult\",key:index},val);});return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"p\",{style:{padding:\"0 5px\"}},/*#__PURE__*/React.createElement(\"b\",null,\"Output Result\")),/*#__PURE__*/React.createElement(\"div\",{className:\"wrapperItemResult\"},items));};//Top bar componenet NOTE that save and load is in developed\nvar NavbarComponent=function NavbarComponent(_ref2){var generateCode=_ref2.generateCode,toggle=_ref2.toggle,save=_ref2.save,input=_ref2.input;return/*#__PURE__*/React.createElement(\"div\",{style:{display:\"flex\",flexDirection:\"row\",alignItems:\"center\",padding:\"10px\",borderBottom:\"1px solid #d2d2d2\"}},/*#__PURE__*/React.createElement(\"div\",{style:{flex:1}},/*#__PURE__*/React.createElement(\"h3\",{style:{padding:0,margin:0}},\"Blockly Editor\")),/*#__PURE__*/React.createElement(\"div\",{style:{}},/*#__PURE__*/React.createElement(\"button\",{onClick:toggle,className:\"previewBtn\"},\"Preview\"),/*#__PURE__*/React.createElement(\"button\",{onClick:generateCode,className:\"compileBtn\"},\"Execute\"),/*#__PURE__*/React.createElement(\"button\",{onClick:save,className:\"saveBtn\"},\"Save\"),/*#__PURE__*/React.createElement(\"input\",{type:\"file\",name:\"file\",onChange:input,className:\"custom-file-input\"})));};//Blockly workspace html, you may add your defined block here\nvar WorkspaceComponent=function WorkspaceComponent(_ref3){var initWorkspaceRef=_ref3.initWorkspaceRef;return/*#__PURE__*/React.createElement(BlocklyComponent,{ref:function ref(instanceRef){initWorkspaceRef(instanceRef);},readOnly:false,trashcan:true,media:\"media/\",move:{scrollbars:true,drag:true,wheel:true}},/*#__PURE__*/React.createElement(Category,{name:\"Logic\",colour:\"210\"},/*#__PURE__*/React.createElement(Block,{type:\"controls_if\"}),/*#__PURE__*/React.createElement(Block,{type:\"logic_compare\"}),/*#__PURE__*/React.createElement(Block,{type:\"logic_operation\"}),/*#__PURE__*/React.createElement(Block,{type:\"logic_negate\"}),/*#__PURE__*/React.createElement(Block,{type:\"logic_boolean\"})),/*#__PURE__*/React.createElement(Category,{name:\"Loops\",colour:\"120\"},/*#__PURE__*/React.createElement(Block,{type:\"controls_repeat_ext\"},/*#__PURE__*/React.createElement(Value,{name:\"TIMES\"},/*#__PURE__*/React.createElement(Block,{type:\"math_number\"},/*#__PURE__*/React.createElement(Field,{name:\"NUM\"},\"10\")))),/*#__PURE__*/React.createElement(Block,{type:\"controls_whileUntil\"})),/*#__PURE__*/React.createElement(Category,{name:\"Text\",colour:\"20\"},/*#__PURE__*/React.createElement(Block,{type:\"text\"}),/*#__PURE__*/React.createElement(Block,{type:\"text_length\"}),/*#__PURE__*/React.createElement(Block,{type:\"text_print\"})),/*#__PURE__*/React.createElement(Category,{name:\"Math\",colour:\"230\"},/*#__PURE__*/React.createElement(Block,{type:\"math_number\"}),/*#__PURE__*/React.createElement(Block,{type:\"math_arithmetic\"}),/*#__PURE__*/React.createElement(Block,{type:\"math_single\"})),/*#__PURE__*/React.createElement(Category,{name:\"MeCab\",colour:\"30\"},/*#__PURE__*/React.createElement(Block,{type:\"ws_import_mecab\"}),/*#__PURE__*/React.createElement(Block,{type:\"ws_tagger\"}),/*#__PURE__*/React.createElement(Block,{type:\"text\"}),/*#__PURE__*/React.createElement(Block,{type:\"text_print\"})));};//Main application window\nvar App=function App(){var loadedContent=\"\";var savedFilename=\"\";var workspaceRef=useRef(null);//workspace ref\nvar _useState=useState(false),_useState2=_slicedToArray(_useState,2),togglePreviewCode=_useState2[0],setTogglePreviewCode=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),executeCodeResponse=_useState4[0],setExecuteCodeResponse=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),codePreview=_useState6[0],setCodePreview=_useState6[1];var getCode=function getCode(event){var codeFromBlock=BlocklyPython.workspaceToCode(//convert code to python\nworkspaceRef.current.workspace);//document.getElementById('text').Value = codeFromBlock;\nsetCodePreview(codeFromBlock);return codeFromBlock;/*let codeFromBlock = Blockly.BlocklyPython.workspacetoCode(workspaceRef);\n    document.getElementById('textarea').Value = codeFromBlock;\n    */};saveWorkspace=function saveWorkspace(){try{var xml=Blockly.Xml.workspaceToDom(workspaceRef.current.workspace);//convert all block to xml\nvar xml_text=Blockly.Xml.domToText(xml);//convert xml to text\nvar response=exportWorkspace(xml_text).then(function(res){//Open an new browser tab to trigger built-in downloader \nsavedFilename=res.data.split(',')[1].split(':')[1];var BASE_URL=\"http://babyai.org:5000/workspace/export/download/\"+savedFilename.replace(/'/g,'');var HEADERS={\"Accept\":\"*/*\"};window.open(BASE_URL,'_blank');}).catch(function(err){alert(err);});}catch(e){alert(e);}};var loadWorkspace=function loadWorkspace(){try{var XML=Blockly.Xml.textToDom(loadedContent);Blockly.Xml.clearWorkspaceAndLoadFromXml(XML,workspaceRef.current.workspace);}catch(e){alert(e);alert('File may be corrupted!');}};//Generate code from block connection\nvar generateCode=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var codeFromBlock,response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:codeFromBlock=getCode();_context.prev=1;_context.next=4;return babyAiService(codeFromBlock);case 4:response=_context.sent;setExecuteCodeResponse(response.data.split(\"\\n\"));_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](1);alert('Cannot execute a code for reason: '+_context.t0);case 11:case\"end\":return _context.stop();}}},_callee,null,[[1,8]]);}));return function generateCode(){return _ref4.apply(this,arguments);};}();//Toggle preview code besied OUTPUT tab\nvar onHandlerTogglePreviewCode=function onHandlerTogglePreviewCode(){var toggle=togglePreviewCode?false:true;getCode();setTogglePreviewCode(toggle);};var onFileChangeHandle=function onFileChangeHandle(event){try{var reader=new FileReader();reader.onload=function(e){var text=e.target.result;loadedContent=text;loadWorkspace();};reader.readAsText(event.target.files[0]);}catch(e){console.log(e);}};//Main rendered window, blockly workspace reference object is called here\nreturn/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(NavbarComponent,{generateCode:generateCode,toggle:onHandlerTogglePreviewCode,save:saveWorkspace,input:onFileChangeHandle}),/*#__PURE__*/React.createElement(WorkspaceComponent,{initWorkspaceRef:function initWorkspaceRef(ref){workspaceRef.current=ref;// Prevent flyout from automatically closed\nBlockly.Flyout.prototype.autoClose=false;//workspace.addChangeListener(getCode); //***add new  */\n}}),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{style:{display:togglePreviewCode?\"none\":\"initial\"}},/*#__PURE__*/React.createElement(ConsoleComponent,{data:executeCodeResponse.map(function(val){return\"> \".concat(val);})})),/*#__PURE__*/React.createElement(\"div\",{style:{display:togglePreviewCode?\"initial\":\"none\"}},/*#__PURE__*/React.createElement(\"div\",{className:\"wrapperToggleView\"},/*#__PURE__*/React.createElement(\"div\",{className:\"box\"},/*#__PURE__*/React.createElement(ConsoleComponent,{data:executeCodeResponse.map(function(val){return\"> \".concat(val);})})),/*#__PURE__*/React.createElement(\"div\",{className:\"box\"},/*#__PURE__*/React.createElement(\"p\",{style:{padding:\"0 5px\"}},/*#__PURE__*/React.createElement(\"b\",null,\"Python Code\")),/*#__PURE__*/React.createElement(CodeBlock,{text:codePreview===\"\"?\"ðŸ”¥ #Let's Started ðŸ”¥ \\n\\n\\n\\n\\n\\n\\n\\n\\n\":codePreview,language:\"python\",showLineNumbers:true,theme:dracula,codeBlock:true}))))));};export default App;","map":{"version":3,"sources":["C:/Users/oneto/OneDrive/Desktop/blockly/src/App.js"],"names":["React","useRef","useState","BlocklyComponent","Block","Value","Field","Category","BlocklyPython","babyAiService","exportWorkspace","downloadSavedWorkspace","CodeBlock","dracula","Blockly","ConsoleComponent","data","items","map","val","index","padding","NavbarComponent","generateCode","toggle","save","input","display","flexDirection","alignItems","borderBottom","flex","margin","WorkspaceComponent","initWorkspaceRef","instanceRef","scrollbars","drag","wheel","App","loadedContent","savedFilename","workspaceRef","togglePreviewCode","setTogglePreviewCode","executeCodeResponse","setExecuteCodeResponse","codePreview","setCodePreview","getCode","event","codeFromBlock","workspaceToCode","current","workspace","saveWorkspace","xml","Xml","workspaceToDom","xml_text","domToText","response","then","res","split","BASE_URL","replace","HEADERS","window","open","catch","err","alert","e","loadWorkspace","XML","textToDom","clearWorkspaceAndLoadFromXml","onHandlerTogglePreviewCode","onFileChangeHandle","reader","FileReader","onload","text","target","result","readAsText","files","console","log","ref","Flyout","prototype","autoClose"],"mappings":"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","sourcesContent":["import React, { useRef, useState} from \"react\";\nimport BlocklyComponent, { Block, Value, Field, Category } from \"./Blockly\";\nimport BlocklyPython from \"blockly/python\";\nimport { babyAiService, exportWorkspace, downloadSavedWorkspace } from \"./services/babyAiService\";\nimport { CodeBlock, dracula } from \"react-code-blocks\";\nimport Blockly from 'blockly'\n\nimport \"./blocks/customblocks\";\nimport \"./generator/generator\";\nimport \"./App.css\";\nimport \"./generator/python_compressed\";\n\n//Container of result from server\nconst ConsoleComponent = ({ data = [] }) => {\n  const items = data.map((val, index) => {\n    return (\n      <div className=\"itemsResult\" key={index}>\n        {val}\n      </div>\n    );\n  });\n  return (\n    <>\n      <p style={{ padding: \"0 5px\" }}>\n        <b>Output Result</b>\n      </p>\n      <div className=\"wrapperItemResult\">{items}</div>\n    </>\n  );\n};\n\n//Top bar componenet NOTE that save and load is in developed\nconst NavbarComponent = ({ generateCode, toggle, save, input}) => {\n  return (\n    <div\n      style={{\n        display: \"flex\",\n        flexDirection: \"row\",\n        alignItems: \"center\",\n        padding: \"10px\",\n        borderBottom: \"1px solid #d2d2d2\",\n      }}\n    >\n      <div style={{ flex: 1 }}>\n        <h3\n          style={{\n            padding: 0,\n            margin: 0,\n          }}\n        >\n          Blockly Editor\n        </h3>\n      </div>\n      <div style={{}}>\n        <button onClick={toggle} className=\"previewBtn\">\n          Preview\n        </button>\n        <button onClick={generateCode} className=\"compileBtn\">\n          Execute\n        </button>\n        {/* Wait for API Line to save and download xml file */}\n        <button onClick={save} className=\"saveBtn\">\n          Save\n        </button>\n        <input type=\"file\" name=\"file\" onChange={input} className=\"custom-file-input\"/>\n        \n      </div>\n    </div>\n  );\n};\n\n//Blockly workspace html, you may add your defined block here\nconst WorkspaceComponent = ({ initWorkspaceRef }) => {\n  return (\n    <BlocklyComponent\n      ref={(instanceRef) => {\n        initWorkspaceRef(instanceRef);\n      }}\n      readOnly={false}\n      trashcan={true}\n      media={\"media/\"}\n      move={{ scrollbars: true, drag: true, wheel: true }}\n    >\n      <Category name=\"Logic\" colour=\"210\">\n        <Block type=\"controls_if\"></Block>\n        <Block type=\"logic_compare\"></Block>\n        <Block type=\"logic_operation\"></Block>\n        <Block type=\"logic_negate\"></Block>\n        <Block type=\"logic_boolean\"></Block>\n      </Category>\n      <Category name=\"Loops\" colour=\"120\">\n        <Block type=\"controls_repeat_ext\">\n          <Value name=\"TIMES\">\n            <Block type=\"math_number\">\n              <Field name=\"NUM\">10</Field>\n            </Block>\n          </Value>\n        </Block>\n        <Block type=\"controls_whileUntil\"></Block>\n      </Category>\n      <Category name=\"Text\" colour=\"20\">\n        <Block type=\"text\"></Block>\n        <Block type=\"text_length\"></Block>\n        <Block type=\"text_print\"></Block>\n      </Category>\n      <Category name=\"Math\" colour=\"230\">\n        <Block type=\"math_number\"></Block>\n        <Block type=\"math_arithmetic\"></Block>\n        <Block type=\"math_single\"></Block>\n      </Category>\n\n      {/* Add our custom block category, tou can place it outside category as well */}\n      <Category name=\"MeCab\" colour=\"30\">\n        <Block type=\"ws_import_mecab\"></Block>\n        <Block type=\"ws_tagger\"></Block>\n        <Block type=\"text\"></Block>\n        <Block type=\"text_print\"></Block>\n      </Category>\n    </BlocklyComponent>\n  );\n};\n\n//Main application window\nconst App = () => {\n  var loadedContent = \"\"\n  var savedFilename = \"\"\n  const workspaceRef = useRef(null); //workspace ref\n\n  const [togglePreviewCode, setTogglePreviewCode] = useState(false);\n  const [executeCodeResponse, setExecuteCodeResponse] = useState([]);\n  const [codePreview, setCodePreview] = useState(\"\");\n  \n    const getCode = (event) => {\n     let codeFromBlock = \n        BlocklyPython.workspaceToCode(  //convert code to python\n        workspaceRef.current.workspace\n      );\n      //document.getElementById('text').Value = codeFromBlock;\n      setCodePreview(codeFromBlock);\n    \n    return codeFromBlock;\n    /*let codeFromBlock = Blockly.BlocklyPython.workspacetoCode(workspaceRef);\n    document.getElementById('textarea').Value = codeFromBlock;\n    */\n  };\n  \nsaveWorkspace =() => {\n    try {\n      var xml = Blockly.Xml.workspaceToDom(workspaceRef.current.workspace); //convert all block to xml\n      var xml_text = Blockly.Xml.domToText(xml); //convert xml to text\n      const response = exportWorkspace(xml_text).then(res => {\n        //Open an new browser tab to trigger built-in downloader \n        savedFilename = res.data.split(',')[1].split(':')[1];\n        const BASE_URL = `http://babyai.org:5000/workspace/export/download/` + savedFilename.replace(/'/g, '');\n        const HEADERS = {\n          \"Accept\": \"*/*\",\n        };\n        window.open(BASE_URL, '_blank');\n      }).catch(err => {\n        alert(err);\n      });\n\n    } catch (e) {\n      alert(e);\n    }\n  }\n  \n  const loadWorkspace = () => {\n    try {\n      const XML = Blockly.Xml.textToDom(loadedContent)\n      Blockly.Xml.clearWorkspaceAndLoadFromXml(XML, workspaceRef.current.workspace)\n    }catch(e){\n      alert(e)\n      alert('File may be corrupted!')\n    }\n\n  }\n  //Generate code from block connection\n  const generateCode = async () => {\n    const codeFromBlock = getCode();\n    try{\n    const response = await babyAiService(codeFromBlock);\n    setExecuteCodeResponse(response.data.split(\"\\n\"));\n    }catch(e) {\n      alert('Cannot execute a code for reason: ' + e)\n    }\n  };\n  //Toggle preview code besied OUTPUT tab\n  const onHandlerTogglePreviewCode = () => {\n    const toggle = togglePreviewCode ? false : true;\n    getCode();\n    setTogglePreviewCode(toggle);\n  };\n\n  const onFileChangeHandle = (event) => {\n    try {\n      const reader = new FileReader();\n      reader.onload = (e) => {\n        const text = (e.target.result)\n        loadedContent = text;\n        loadWorkspace();\n      }\n      reader.readAsText(event.target.files[0])\n    }catch(e) {\n      console.log(e)\n    }\n  }\n\n  //Main rendered window, blockly workspace reference object is called here\n  \n  return (\n    <>\n      <NavbarComponent\n        generateCode={generateCode}\n        toggle={onHandlerTogglePreviewCode}\n        save={saveWorkspace}\n        input={onFileChangeHandle}\n      />\n        <WorkspaceComponent\n          initWorkspaceRef={(ref) => {\n            workspaceRef.current = ref;\n            // Prevent flyout from automatically closed\n            Blockly.Flyout.prototype.autoClose = false\n            //workspace.addChangeListener(getCode); //***add new  */\n          }}/>\n      <div>\n      {/* PREVIEW button is press (toggle state), disply output*/}\n      <div style={{ display: togglePreviewCode ? \"none\" : \"initial\" }}> \n        <ConsoleComponent data={executeCodeResponse.map((val) => `> ${val}`)} />\n      </div>\n \n      {/* PREVIEW button is press (toggle state), display python code and output side by side*/}\n      <div style={{ display: togglePreviewCode ? \"initial\" : \"none\" }}> \n          <div className=\"wrapperToggleView\">\n            <div className=\"box\">\n              <ConsoleComponent data={executeCodeResponse.map((val) => `> ${val}`)} />\n              \n            </div>\n\n            <div className=\"box\">    \n            <p style={{ padding: \"0 5px\" }}>\n              <b>Python Code</b>\n            </p>      \n              <CodeBlock\n                 text={\n                    codePreview === \"\"\n                      ? \"ðŸ”¥ #Let's Started ðŸ”¥ \\n\\n\\n\\n\\n\\n\\n\\n\\n\"\n                      : codePreview\n                  }\n                  language={\"python\"}\n                  showLineNumbers={true}\n                  theme={dracula}\n                  codeBlock\n              />\n            </div>\n           \n          </div>\n      </div>\n      \n      </div>\n      \n    </>\n  );\n};\n\nexport default App;"]},"metadata":{},"sourceType":"module"}